Jedox.studio.files.openAddGroup=function(operation,fn,groupNameList){Jedox.studio.app.lastInputMode=Jedox.studio.app.inputMode;Jedox.studio.app.inputMode=Jedox.studio.app.inputMode_studio_DEFAULT;var groupNameTxf=new Ext.form.TextField({fieldLabel:"Group Name".localize(),labelStyle:"font-size:11px;",enableKeyEvents:true,width:150});var descriptionTxa=new Ext.form.TextArea({fieldLabel:"Description".localize(),labelStyle:"font-size:11px;",cls:"preview-properties-panel",name:"description",width:150});var mainPanel=new Ext.Panel({modal:true,layout:"form",baseCls:"main-panel",border:false,items:[groupNameTxf,descriptionTxa]});function showWarrningMessage(name){win.hide();var informationMsg="informationMsg".localize();var adviceMsg="adviceMsg".localize();Ext.Msg.show({title:"Rename Sheet".localize()+"?",msg:"<b>"+name+"</b> "+informationMsg+"?<br>"+adviceMsg+".",buttons:Ext.Msg.OK,fn:function(){win.show();sheetNewNameTxf.selectText();sheetNewNameTxf.focus(true,true)},animEl:"elId",width:320,icon:Ext.MessageBox.ERROR})}function validateGroup(name){var _return=true;function isFormatAllowed(){var msg="group_name_name_format_err_msg".localize()+"...";var my_regexp=/^[a-zA-Z][a-zA-Z0-9_\-@\.\ ]+$/;var value=name;if(!my_regexp.test(value)){groupNameTxf.markInvalid(msg);_return=false}}function isNameAllowed(){var msg="group_name_name_exits_err_msg".localize()+"...";if(name in groupNameList){groupNameTxf.markInvalid(msg);_return=false}}isFormatAllowed();isNameAllowed();return _return}function onOK(){var name=groupNameTxf.getValue();var desc=descriptionTxa.getValue();if(validateGroup(name)){fn(name,desc);win.close()}}var win=new Ext.Window({defaults:{bodyStyle:"padding:10px"},title:"New Folder Group".localize(),closable:true,closeAction:"close",autoDestroy:true,plain:true,constrain:true,modal:true,resizable:false,animCollapse:false,layout:"fit",width:300,height:180,items:mainPanel,listeners:{close:function(){Jedox.studio.app.inputMode=Jedox.studio.app.lastInputMode}},buttons:[{text:"OK".localize(),handler:onOK},{text:"Cancel".localize(),handler:function(){win.close()}}]});win.show(this)};Jedox.studio.files.openAddHierarchy=function(operation,fn,hierarchyNameList){Jedox.studio.app.lastInputMode=Jedox.studio.app.inputMode;Jedox.studio.app.inputMode=Jedox.studio.app.inputMode_studio_DEFAULT;var hierarchyNameTxf=new Ext.form.TextField({fieldLabel:"Hierarchy Name".localize(),labelStyle:"font-size:11px;",enableKeyEvents:true,width:200});var descriptionTxa=new Ext.form.TextArea({fieldLabel:"Description".localize(),labelStyle:"font-size:11px;",cls:"preview-properties-panel",name:"description",width:200});var splitLine={html:"<br><br>",baseCls:"split-line",width:305};var typeTxf=new Ext.form.TextField({fieldLabel:"Type".localize(),labelStyle:"font-size:11px;",enableKeyEvents:true,width:150});var locationLbl={html:"Location",baseCls:"x-plain"};var locationTxf=new Ext.form.TextField({fieldLabel:"Location (path)".localize(),labelStyle:"font-size:11px;",enableKeyEvents:true,width:200});var mainPanel=new Ext.Panel({modal:true,layout:"form",baseCls:"main-panel",border:false,items:[hierarchyNameTxf,descriptionTxa,splitLine,locationTxf]});function showWarrningMessage(name){win.hide();var informationMsg="informationMsg".localize();var adviceMsg="adviceMsg".localize();Ext.Msg.show({title:"Rename Sheet".localize()+"?",msg:"<b>"+name+"</b> "+informationMsg+"?<br>"+adviceMsg+".",buttons:Ext.Msg.OK,fn:function(){win.show();sheetNewNameTxf.selectText();sheetNewNameTxf.focus(true,true)},animEl:"elId",width:320,icon:Ext.MessageBox.ERROR})}function validateHierarchy(name){var _return=true;function isFormatAllowed(){var msg="hierarchy_name_name_format_err_msg".localize()+"...";var my_regexp=/^[a-zA-Z][a-zA-Z0-9_\-@\.\ ]+$/;var value=name;if(!my_regexp.test(value)){hierarchyNameTxf.markInvalid(msg);_return=false}}function isNameAllowed(){var msg="hierarchy_name_name_exits_err_msg".localize()+"...";if(name in hierarchyNameList){hierarchyNameTxf.markInvalid(msg);_return=false}}isFormatAllowed();isNameAllowed();return _return}function initNew(){var defaultPath=Jedox.studio.backend.wssStudio.getDefaultLocalPath();locationTxf.setValue(defaultPath[0])}function onOK(){var name=hierarchyNameTxf.getValue();var desc=descriptionTxa.getValue();var path=locationTxf.getValue();if(validateHierarchy(name)){fn(name,desc,path);win.close()}}var win=new Ext.Window({defaults:{bodyStyle:"padding:10px"},title:"New File Repository".localize(),closable:true,closeAction:"close",autoDestroy:true,plain:true,constrain:true,modal:true,resizable:false,animCollapse:false,layout:"fit",width:350,height:230,items:mainPanel,listeners:{close:function(){Jedox.studio.app.inputMode=Jedox.studio.app.lastInputMode}},buttons:[{text:"OK".localize(),handler:onOK},{text:"Cancel".localize(),handler:function(){win.close()}}]});initNew();win.show(this)};Jedox.studio.files.openAddHyperlink=function(callBackFnc){Jedox.studio.app.lastInputMode=Jedox.studio.app.inputMode;Jedox.studio.app.inputMode=Jedox.studio.app.inputMode_studio_DEFAULT;var hyperlinkNameTxf=new Ext.form.TextField({fieldLabel:"Hiperlink Name".localize(),labelStyle:"font-size:11px;",enableKeyEvents:true,width:200});var descriptionTxa=new Ext.form.TextArea({fieldLabel:"Description".localize(),labelStyle:"font-size:11px;",cls:"preview-properties-panel",name:"description",width:200});var splitLine={html:"<br><br>",baseCls:"split-line",width:305};var locationTxf=new Ext.form.TextField({fieldLabel:"URL (path)".localize(),labelStyle:"font-size:11px;",enableKeyEvents:true,width:200});var targetData=[["self","open in Studio".localize()],["blank","open in New window".localize()]];var targetStore=new Ext.data.SimpleStore({fields:["id","name"],data:targetData});var targetCmb=new Ext.form.ComboBox({fieldLabel:"Target".localize(),store:targetStore,displayField:"name",valueField:"id",value:"self",readOnly:false,editable:false,typeAhead:true,mode:"local",triggerAction:"all",selectOnFocus:true,listWidth:140,width:140});var mainPanel=new Ext.Panel({modal:true,layout:"form",baseCls:"main-panel",border:false,items:[hyperlinkNameTxf,descriptionTxa,splitLine,locationTxf,targetCmb]});function showWarrningMessage(name){win.hide();var informationMsg="informationMsg".localize();var adviceMsg="adviceMsg".localize();Ext.Msg.show({title:"Rename Sheet".localize()+"?",msg:"<b>"+name+"</b> "+informationMsg+"?<br>"+adviceMsg+".",buttons:Ext.Msg.OK,fn:function(){win.show();sheetNewNameTxf.selectText();sheetNewNameTxf.focus(true,true)},animEl:"elId",width:320,icon:Ext.MessageBox.ERROR})}function onOK(){var name=hyperlinkNameTxf.getValue();var desc=descriptionTxa.getValue();var url=locationTxf.getValue();var target=targetCmb.getValue();if(callBackFnc(name,desc,url,target)){win.close()}}var win=new Ext.Window({defaults:{bodyStyle:"padding:10px"},title:"New Hyperlink".localize(),closable:true,closeAction:"close",autoDestroy:true,plain:true,constrain:true,modal:true,resizable:false,animCollapse:false,layout:"fit",width:350,height:260,items:mainPanel,listeners:{close:function(){Jedox.studio.app.inputMode=Jedox.studio.app.lastInputMode}},buttons:[{text:"OK".localize(),handler:onOK},{text:"Cancel".localize(),handler:function(){win.close()}}]});win.show(this)};