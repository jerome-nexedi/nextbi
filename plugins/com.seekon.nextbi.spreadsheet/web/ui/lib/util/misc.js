Jedox.util=new function(){this.extend=function(subclass,parent){var F=function(){};F.prototype=parent.prototype;subclass.prototype=new F();subclass.prototype.constructor=subclass;subclass.parent=parent.prototype;if(parent.prototype.constructor==Object.prototype.constructor){parent.prototype.constructor=parent}};this.addEvent=function(obj,type,func,capture){if(obj.addEventListener){obj.addEventListener(type,func,capture);return true}if(obj.attachEvent){return obj.attachEvent("on".concat(type),func)}};this.ignoreSelection=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.stopPropagation()}else{ev.cancelBubble=true}return false};this.unignoreSelection=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.stopPropagation()}else{ev.cancelBubble=true}return true};this.setText=document.getElementsByTagName("body")[0].innerText!=undefined?function(obj,text){obj.innerText=text}:function(obj,text){obj.textContent=text};this.cols2Tree=function(vals,isReversed){if(typeof vals!="object"){return[]}if(isReversed){var name_idx=0,alias_idx=1,lvl_idx=2}else{var lvl_idx=0,name_idx=1,alias_idx=2}var len=vals.length,name,alias,curr_lvl,list=[],curr_lists={};if(len&&len%3==0&&typeof(curr_lvl=vals[lvl_idx])=="number"){name=vals[name_idx];alias=vals[alias_idx];if(alias==""){alias=name}curr_lists[curr_lvl]=list;for(var lvl,lvl_prev=curr_lvl,i=3;i<len;i+=3){lvl=vals[i+lvl_idx];if(lvl>lvl_prev){curr_lists[lvl]=curr_lists[curr_lvl][curr_lists[curr_lvl].push({val:name,text:alias,leaf:false,children:[]})-1].children}else{curr_lists[curr_lvl].push({val:name,text:alias,leaf:true})}lvl_prev=lvl;if(lvl in curr_lists){curr_lvl=lvl}name=vals[i+name_idx];if((alias=vals[i+alias_idx])==""){alias=name}}curr_lists[curr_lvl].push({val:name,text:alias,leaf:true})}else{for(var val,i=0;i<len;++i){val=vals[i],list.push({val:val,text:val,leaf:true})}}return list};this.reg2rng=function(ul,w,h){return ul.concat(ul[0]+w-1,ul[1]+h-1)};this.rngCap=function(rng,pt){if(rng[2]>pt[0]){rng[2]=pt[0]}if(rng[3]>pt[1]){rng[3]=pt[1]}};this.objFlip=function(obj){flip={};for(var key in obj){flip[obj[key]]=key}return flip};this.serializer=new function(){var meta_map={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},meta_re=/[\\\"\x08\x09\x0a\x0c\x0d]/g;function meta_repl(c){return meta_map[c]}function quote(str,out){meta_re.lastIndex=0;out.push('"',(meta_re.test(str)?str.replace(meta_re,meta_repl):str),'"')}this.enc=function(v,out){var f=out instanceof Array?false:(out=["("],true);switch(typeof(v)){case"string":quote(v,out);break;case"number":case"boolean":out.push(v);break;case"object":if(v===null){out.push("null")}else{if(v instanceof Array){out.push("[");var l=v.length,i=0,c=false;while(i<l){if(c){out.push(",")}this.enc(v[i++],out);c=true}out.push("]")}else{if(v instanceof String){quote(v,out)}else{if(v instanceof Number||v instanceof Boolean){out.push(v)}else{out.push("{");var c=false,k;for(k in v){if(c){out.push(",")}out.push('"',k,'":');this.enc(v[k],out);c=true}out.push("}")}}}}break;default:out.push("undefined");break}if(f){out.push(")");return out.join("")}};this.dec=function(str){return eval(str)}};this.offsetLeft=function(el){return el.offsetLeft};this.offsetTop=function(el){return el.offsetTop};this.getSelection=function(el){if("selectionStart" in el){return{start:el.selectionStart,end:el.selectionEnd}}var sel=el.createTextRange(),pre=el.createTextRange();sel.moveToBookmark(document.selection.createRange().getBookmark());pre.collapse(true);pre.setEndPoint("EndToStart",sel);var start=pre.text.length;return{start:start,end:start+sel.text.length}};this.getSelected=function(el){var sel;return(sel=document.selection)?(sel.type=="Text"?sel.createRange().text:""):el.value.substring(el.selectionStart,el.selectionEnd)}};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length,from=Number(arguments[1])||0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0){from+=len}for(;from<len;from++){if(from in this&&this[from]===elt){return from}}return -1}}if(!Array.prototype.forEach){Array.prototype.forEach=function(fun){if(typeof fun!="function"){throw new TypeError()}for(var len=this.length,thisp=arguments[1],i=0;i<len;i++){if(i in this){fun.call(thisp,this[i],i,this)}}}}if(!Array.prototype.compare){Array.prototype.compare=function(testArr){if(this.length!=testArr.length){return false}for(var i=0;i<testArr.length;i++){if(this[i].compare){if(!this[i].compare(testArr[i])){return false}}if(this[i]!==testArr[i]){return false}}return true}}if(!String.prototype.entityify){String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}};