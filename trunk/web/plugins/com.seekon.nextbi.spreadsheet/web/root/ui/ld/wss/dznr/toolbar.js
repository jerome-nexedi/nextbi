Jedox.wss.app.onFormatDropdownSelect=function(item,record,index){var styleType=Jedox.wss.app.getToolbarItemID(item.getId());if(styleType!=null){Jedox.wss.style.setFromBar(styleType,item.getValue())}Ext.get("tbarFontSizes").blur();Jedox.wss.general.setInputMode(Jedox.wss.app.lastInputMode);Jedox.wss.app.lastInputMode=Jedox.wss.grid.GridMode.READY};Jedox.wss.app.onFormatDropdownFocus=function(item){Jedox.wss.app.lastInputMode=Jedox.wss.app.environment.inputMode;Jedox.wss.general.setInputMode(Jedox.wss.grid.GridMode.CNTRL)};Jedox.wss.app.onFormatDropdownBlur=function(item){var oldFontSize=Jedox.wss.app.environment.selectedCell.style.fontSize;if((oldFontSize!="")&&(oldFontSize.indexOf("pt")!=-1)){oldFontSize=oldFontSize.substr(0,oldFontSize.indexOf("pt"))}else{oldFontSize=Jedox.wss.app.cnfDefaultFontSize}if(oldFontSize!=item.getRawValue()){var styleType=Jedox.wss.app.getToolbarItemID(item.getId());if(styleType!=null){Jedox.wss.style.setFromBar(styleType,item.getRawValue())}}Ext.get("tbarFontSizes").blur();Jedox.wss.general.setInputMode(Jedox.wss.app.lastInputMode);Jedox.wss.app.lastInputMode=Jedox.wss.grid.GridMode.READY};Jedox.wss.app.onFormatDropdownChange=function(item,newValue,oldValue){var styleType=Jedox.wss.app.getToolbarItemID(item.getId());if(styleType!=null){Jedox.wss.style.setFromBar(styleType,newValue)}Ext.get("tbarFontSizes").blur();Jedox.wss.general.setInputMode(Jedox.wss.app.lastInputMode);Jedox.wss.app.lastInputMode=Jedox.wss.grid.GridMode.READY};Jedox.wss.app.onFormatDropdownSpecKey=function(item,e){var key=Jedox.wss.app.lastKeyPressed;if(key==e.ENTER||key==e.TAB){var oldFontSize=Jedox.wss.app.environment.selectedCell.style.fontSize;if((oldFontSize!="")&&(oldFontSize.indexOf("pt")!=-1)){oldFontSize=oldFontSize.substr(0,oldFontSize.indexOf("pt"))}else{oldFontSize=Jedox.wss.app.cnfDefaultFontSize}if(oldFontSize!=item.getRawValue()){var styleType=Jedox.wss.app.getToolbarItemID(item.getId());if(styleType!=null){Jedox.wss.style.setFromBar(styleType,item.getRawValue())}}Ext.get("tbarFontSizes").blur();Jedox.wss.general.setInputMode(Jedox.wss.app.lastInputMode);Jedox.wss.app.lastInputMode=Jedox.wss.grid.GridMode.READY}};Jedox.wss.app.getToolbarItemID=function(itemName){var toolbarItems={tbarBold:1,tbarItalic:2,tbarUnderline:3,tbarAlignLeft:4,tbarAlignCenter:5,tbarAlignRight:6,tbarFontSizes:7,tbarFonts:8,tbarBgColor:9,tbarBgColorBtn:9,tbarTextColor:10,tbarTextColorBtn:10};return toolbarItems[itemName]};Jedox.wss.app.onFormatItemToggle=function(item,pressed){var styleType=Jedox.wss.app.getToolbarItemID(item.getId());if(styleType!=null&&Jedox.wss.app.performItemToggle){Jedox.wss.style.setFromBar(styleType,pressed)}};Jedox.wss.app.onColorSelect=function(item,color){var bgColor=Jedox.wss.app.toolbar.bgColor;if(bgColor){bgColor.hide()}var styleType=Jedox.wss.app.getToolbarItemID(item.getId());if(!styleType){styleType=Jedox.wss.app.getToolbarItemID(item.ownerCt.getId())}if(item.id=="bgNoColor"){color="transparent";Jedox.wss.app.cnfDefaultBgColor=color;Ext.DomQuery.selectNode("*[class*=iconbgcolor]").style.borderLeft="solid 4px "+color;Jedox.wss.style.setFromBar(9,color)}else{if(typeof color=="string"){if(styleType==Jedox.wss.app.getToolbarItemID("tbarBgColor")){Jedox.wss.app.cnfDefaultBgColor=color;Ext.DomQuery.selectNode("*[class*=iconbgcolor]").style.borderLeft="solid 4px #"+color}else{Jedox.wss.app.cnfDefaultTextColor=color;Ext.DomQuery.selectNode("*[class*=icontextcolor]").style.borderLeft="solid 4px #"+color}}else{color=(styleType==Jedox.wss.app.getToolbarItemID("tbarBgColor"))?Jedox.wss.app.cnfDefaultBgColor:Jedox.wss.app.cnfDefaultTextColor}}if(styleType!=null){Jedox.wss.style.setFromBar(styleType,color)}};Jedox.wss.app.onBorderSelect=function(item,ev){var env=Jedox.wss.app.environment,rngStartCoord=env.lastRangeStartCoord,rngEndCoord=env.lastRangeEndCoord,btnBorders=Jedox.wss.app.toolbar.border,itemID=(item.getId()==btnBorders.getId())?Jedox.wss.app.cnfDefaultBorder:item.getId(),brdConf;switch(itemID){case"brd-bottom-norm":brdConf={bottom:{width:"1px",type:"solid",color:"#000000"}};break;case"brd-top-norm":brdConf={top:{width:"1px",type:"solid",color:"#000000"}};break;case"brd-left-norm":brdConf={left:{width:"1px",type:"solid",color:"#000000"}};break;case"brd-right-norm":brdConf={right:{width:"1px",type:"solid",color:"#000000"}};break;case"brd-all-none":brdConf={all:{type:"none"}};break;case"brd-all-norm":brdConf={all:{width:"1px",type:"solid",color:"#000000"}};break;case"brd-out-norm":brdConf={out:{width:"1px",type:"solid",color:"#000000"}};break;case"brd-out-thick":brdConf={out:{width:"2px",type:"solid",color:"#000000"}};break;case"brd-bottom-thick":brdConf={bottom:{width:"2px",type:"solid",color:"#000000"}};break;case"brd-top-bottom-norm":brdConf={top:{width:"1px",type:"solid",color:"#000000"},bottom:{width:"1px",type:"solid",color:"#000000"}};break;case"brd-top-norm-bottom-thick":brdConf={top:{width:"1px",type:"solid",color:"#000000"},bottom:{width:"2px",type:"solid",color:"#000000"}}}Jedox.wss.style.setBorder(brdConf);btnBorders.setIconClass("icon-".concat(itemID));btnBorders.getEl().child(btnBorders.buttonSelector).dom.qtip=Ext.getCmp(itemID).text;Jedox.wss.app.cnfDefaultBorder=itemID};Jedox.wss.app.openViewMode=function(){window.open("/spreadsheet/root/ui/app/view.php?wam=designer","winUserMode","directories=no,menubar=no,toolbar=no,location=no,status=no,resizable=yes,scrollbars=no")};Jedox.wss.app.updateUndoState=function(undoState,updState){var env=Jedox.wss.app.environment;if(env==null){return}if(undoState==undefined){undoState=env.undoState}else{if(updState==undefined||updState){env.undoState=undoState}}if(true){this.toolbar.undoItem.enable();if(this.menubar){this.menubar.undoItem.setText("Undo".localize());this.menubar.undoItem.enable()}}else{this.toolbar.undoItem.disable();if(this.menubar){this.menubar.undoItem.setText("Can't Undo".localize());this.menubar.undoItem.disable()}}if(true){this.toolbar.redoItem.enable();if(this.menubar){this.menubar.redoItem.setText("Redo".localize());this.menubar.redoItem.enable()}}else{this.toolbar.redoItem.disable();if(this.menubar){this.menubar.redoItem.setText("Can't Redo".localize());this.menubar.redoItem.disable()}}};Jedox.wss.app.hideBar=function(barId){var bar=Ext.get(barId);bar.setVisibilityMode(Ext.Element.DISPLAY);bar.hide();Jedox.wss.workspace.resize();Jedox.wss.workspace.resizeMaxWindows()};Jedox.wss.app.showBar=function(barId){var bar=Ext.get(barId);bar.setVisibilityMode(Ext.Element.DISPLAY);bar.show();Jedox.wss.workspace.resize();Jedox.wss.workspace.resizeMaxWindows()};Jedox.wss.app.hideToolbar=function(toolbar){Jedox.wss.app.hideBar("Toolbar")};Jedox.wss.app.showToolbar=function(toolbar){Jedox.wss.app.showBar("Toolbar")};Jedox.wss.app.hideShowToolbar=function(state,toolbar){if(state){Jedox.wss.app.showToolbar(toolbar)}else{Jedox.wss.app.hideToolbar(toolbar)}};Jedox.wss.app.hideShowFormulaBar=function(state){if(state){Jedox.wss.app.showBar("formulaBar")}else{Jedox.wss.app.hideBar("formulaBar")}};Jedox.wss.app.initMenuBar=function(){var menu=Jedox.wss.app.menubar={},rngClearType=Jedox.wss.range.ContentType;Jedox.wss.app.Menu=new Ext.Toolbar({cls:"extmenubar"});Jedox.wss.app.Menu.add({text:"File".localize(),cls:"extmenubaritem",menu:(menu.fileMenu=new Ext.menu.Menu({id:"FileMenu",cls:"default-format-window",items:[{text:"New".localize().concat("..."),iconCls:"icon_new_doc",handler:Jedox.wss.action.newWorkbook},{text:"Open".localize().concat("..."),iconCls:"icon_open_doc",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.open,["open"])}},{text:"Open Recent".localize(),id:"openRecentMenu",menu:{items:[],cls:"default-format-window",listeners:{beforeshow:function(){if(this.loaded){return true}var jwgnrl=Jedox.wss.general;Jedox.wss.backend.conn.rpc([jwgnrl,jwgnrl.showRecent,this,this.parentMenu.activeItem.getEl(),"tr",this.parentMenu],"common","fetchRecent",["files","spreadsheet"]);return false}}}},{text:"Import".localize().concat("..."),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.importFile)}},{text:"Export".localize(),menu:{cls:"default-format-window",items:[{text:"XLSX".localize(),iconCls:"icon_file_xlsx",handler:Jedox.wss.action.exportToXLSX},{text:"PDF".localize(),iconCls:"icon_file_pdf",handler:Jedox.wss.action.exportToPDF,disabled:!Jedox.wss.app.fopper},{text:"HTML".localize(),iconCls:"icon_file_html",handler:Jedox.wss.action.exportToHTML}]}},{text:"Quick Publish".localize(),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.quickPublish)}},{text:"Close".localize(),handler:function(){if(Jedox.wss.workspace.activeWin!=null){Jedox.wss.workspace.activeWin.close()}}},"-",(menu.saveItem=new Ext.menu.Item({text:"Save".localize(),handler:Jedox.wss.book.save,iconCls:"icon_save_doc"})),(menu.saveAsItem=new Ext.menu.Item({text:"Save as".localize().concat("..."),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.open,["save"])}})),"-",{text:"Page Setup".localize().concat("..."),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.pageSetup)}},{text:"Print Area".localize(),disabled:true},{text:"Print Preview".localize(),handler:Jedox.wss.action.exportToHTML}],listeners:{hide:function(){this.items.get("openRecentMenu").menu.loaded=false}}}))},{text:"Edit".localize(),cls:"extmenubaritem",menu:new Ext.menu.Menu({id:"EditMenu",cls:"default-format-window",items:[(menu.undoItem=new Ext.menu.Item({text:"Undo".localize(),iconCls:"icon_undo",handler:Jedox.wss.sheet.undo,hidden:true})),(menu.redoItem=new Ext.menu.Item({text:"Redo".localize(),iconCls:"icon_redo",handler:Jedox.wss.sheet.redo,hidden:true})),{text:"Cut".localize(),iconCls:"icon_cut",handler:function(){Jedox.wss.action.cut(false)}},{text:"Copy".localize(),iconCls:"icon_copy",handler:function(){Jedox.wss.action.copy(false)}},(menu.paste=new Ext.menu.Item({text:"Paste".localize(),iconCls:"icon_paste",disabled:true,handler:Jedox.wss.action.paste})),(menu.pasteSpec=new Ext.menu.Item({text:"Paste Special".localize().concat("..."),disabled:true,handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.pasteSpecial,[])}})),"-",{text:"Clear".localize(),iconCls:"icon_clear_all",menu:{cls:"default-format-window",items:[{text:"Clear All".localize(),iconCls:"icon_clear_all",handler:function(){Jedox.wss.action.clear(rngClearType.ALL_CLEAR)}},{text:"Clear Formats".localize(),iconCls:"icon_clear_formats",handler:function(){Jedox.wss.action.clear(rngClearType.STYLE|rngClearType.FORMAT|rngClearType.CNDFMT)}},{text:"Clear Contents".localize(),iconCls:"icon_clear_content",handler:function(){Jedox.wss.action.clear(rngClearType.FORMULA)}}]}},(menu.delRow=new Ext.menu.Item({text:"Delete Rows".localize(),iconCls:"icon_del_row",handler:function(){Jedox.wss.action.insDelRowCol("del","row")}})),(menu.delCol=new Ext.menu.Item({text:"Delete Columns".localize(),iconCls:"icon_del_col",handler:function(){Jedox.wss.action.insDelRowCol("del","col")}})),"-",{text:"Go To".localize().concat("..."),iconCls:"icon_goto",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.goTo)}}]})},{text:"View".localize(),cls:"extmenubaritem",menu:new Ext.menu.Menu({id:"ViewMenu",cls:"default-format-window",items:[{text:"Toolbars".localize(),enableToggle:true,checked:true,checkHandler:function(btn,state){Jedox.wss.app.hideShowToolbar(state,"")}},{text:"Formula Bar".localize(),enableToggle:true,checked:true,checkHandler:function(btn,state){Jedox.wss.app.hideShowFormulaBar(state)}},{text:"Status Bar".localize(),enableToggle:true,checked:true,checkHandler:function(btn,state){Jedox.wss.app.statusBar.hideShow(state)}},"-",(menu.hbQuickView=new Ext.menu.CheckItem({text:"Quick View".localize(),enableToggle:true,checked:false,checkHandler:Jedox.wss.hb.run})),(menu.userModeView=new Ext.menu.Item({text:"User Mode".localize(),handler:Jedox.wss.app.openViewMode}))]})},{text:"Insert".localize(),cls:"extmenubaritem",menu:new Ext.menu.Menu({id:"InsertMenu",cls:"default-format-window",items:[(menu.insRow=new Ext.menu.Item({text:"Rows".localize(),iconCls:"icon_ins_row",handler:function(){Jedox.wss.action.insDelRowCol("ins","row")}})),(menu.insCol=new Ext.menu.Item({text:"Columns".localize(),iconCls:"icon_ins_col",handler:function(){Jedox.wss.action.insDelRowCol("ins","col")}})),{text:"Worksheet".localize(),iconCls:"icon_ins_sheet",handler:function(){Jedox.wss.app.activeBook.getSheetSelector().addSheet()}},{text:"Chart".localize().concat("..."),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.chart,["insert",0])},iconCls:"icon_insert_chart"},{text:"Micro Chart".localize().concat("..."),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.microChart)},iconCls:"icon_insert_chart"},"-",{text:"Function".localize().concat("..."),iconCls:"icon_ins_func",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.insertFunction)}},{text:"Name".localize(),iconCls:"icon_name_mgr",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.nameManager)}},"-",{text:"Picture".localize(),iconCls:"icon_ins_picture",handler:function(){Jedox.wss.dialog.openInsertPicture()}},{text:"Hyperlink".localize().concat("..."),iconCls:"icon_insert_hyperlink",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.openHL)}}]})},{text:"Format".localize(),cls:"extmenubaritem",menu:new Ext.menu.Menu({id:"FormatMenu",cls:"default-format-window",items:[{text:"Cells".localize().concat("..."),iconCls:"icon_edit",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.formatCells)}},"-",{text:"Row Height".localize().concat("..."),iconCls:"icon_row_height",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.formatColRow,[Jedox.wss.grid.headerType.ROW,Jedox.wss.app.environment.cursorField.offsetHeight+1])}},{text:"Autofit Row Height".localize(),handler:function(){Jedox.wss.action.resizeRowCol(Jedox.wss.grid.headerType.ROW)}},"-",{text:"Column Width".localize().concat("..."),iconCls:"icon_col_width",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.formatColRow,[Jedox.wss.grid.headerType.COLUMN,Jedox.wss.app.environment.cursorField.offsetWidth+2])}},{text:"Autofit Column Width".localize(),handler:function(){Jedox.wss.action.resizeRowCol(Jedox.wss.grid.headerType.COLUMN)}},"-",{text:"Merge Cells".localize(),iconCls:"icon_merge_cells",handler:function(){Jedox.wss.action.mergeCells(false)}},{text:"Unmerge Cells".localize(),iconCls:"icon_unmerge_cells",handler:function(){Jedox.wss.action.mergeCells(true)}},"-",{text:"Conditional Formatting".localize(),iconCls:"icon_conditional_fmt",menu:{cls:"default-format-window",items:[{text:"New Rule".localize().concat("..."),iconCls:"icon_cnd_new",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.conditionalFormatting)}},{text:"Clear Rules".localize(),iconCls:"icon_cnd_clear",menu:{cls:"default-format-window",items:[{text:"Clear Rules from Selected Cells".localize(),handler:function(){Jedox.wss.cndfmt.remove(Jedox.wss.cndfmt.SCOPE_CURR_SEL)}},{text:"Clear Rules from Entire Sheet".localize(),handler:function(){Jedox.wss.cndfmt.remove(Jedox.wss.cndfmt.SCOPE_CURR_WKS)}}]}},{text:"Manage Rules".localize().concat("..."),iconCls:"icon_cnd_manage",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.manageConditionalFormatting)}}]}}]})},{text:"Palo".localize(),cls:"extmenubaritem",menu:new Ext.menu.Menu({id:"PaloMenu",cls:"default-format-window",items:[{text:"Paste View".localize().concat("..."),iconCls:"icon_palo_pasteview",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.pasteView)}},"-",{text:"Paste Elements".localize().concat("..."),iconCls:"icon_palo_pasteelements",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.selectElements)}},{text:"Paste Subset".localize().concat("..."),iconCls:"icon_palo_pastesubset",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.subsetEditor)}},{text:"Paste Data Function".localize().concat("..."),iconCls:"icon_palo_pastedatafn",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.pasteDataFunctions)}},"-",{text:"Data Import".localize().concat("..."),iconCls:"icon_palo_dataimport",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.paloImport)}},{text:"Save as Snapshot".localize().concat("..."),iconCls:"icon_palo_saveassnap",disabled:true}]})},{text:"Data".localize(),cls:"extmenubaritem",menu:new Ext.menu.Menu({id:"DataMenu",cls:"default-format-window",items:[{text:"Refresh Data".localize(),handler:function(){Jedox.wss.app.activeSheet.recalc()}},{text:"Auto-Refresh Data".localize(),id:"autoRefreshDataMenu",enableToggle:true,checked:false,checkHandler:function(){this.checked?Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.autoRefreshStart):Jedox.wss.book.autoRefresh(0)}},"-",{text:"Auto-Calculate Data".localize(),id:"autoCalcDataItem",enableToggle:true,checked:false,checkHandler:function(){Jedox.wss.general.autoCalc(this.checked)}}],listeners:{beforeshow:function(){var aBook=Jedox.wss.app.activeBook;this.items.get("autoRefreshDataMenu").setChecked(aBook&&aBook._autoRefresh>0,true);this.items.get("autoCalcDataItem").setChecked(Jedox.wss.app.autoCalc,true)}}})},{text:"Tools".localize(),cls:"extmenubaritem",menu:new Ext.menu.Menu({id:"ToolsMenu",cls:"default-format-window",items:[{text:"DynaRanges".localize(),iconCls:"icon_dynaranges",menu:{cls:"default-format-window",items:[(menu.newHBVert=new Ext.menu.Item({id:"newHBVertMenubar",text:"Vertical DynaRange".localize(),iconCls:"icon_vert_dynarange",handler:Jedox.wss.hb.addDynarange})),(menu.newHBHoriz=new Ext.menu.Item({id:"newHBHorizMenubar",text:"Horizontal DynaRange".localize(),iconCls:"icon_hor_dynarange",handler:Jedox.wss.hb.addDynarange}))]}},"-",{text:"Form Elements".localize(),iconCls:"icon_form_elems",menu:{cls:"default-format-window",items:[{text:"ComboBox".localize().concat("..."),iconCls:"icon_form_combo",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.formatControl,[{type:Jedox.wss.wsel.type.COMBO_BOX}])}},{text:"CheckBox".localize().concat("..."),iconCls:"icon_form_checkbox",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.formatControl,[{type:Jedox.wss.wsel.type.CHECK_BOX}])}},{text:"Button".localize().concat("..."),iconCls:"icon_form_button",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.formatControl,[{type:Jedox.wss.wsel.type.BUTTON}])}}]}},{text:"Macros".localize(),iconCls:"icon_macro",menu:{cls:"default-format-window",items:[{text:"Macro Editor".localize().concat("..."),iconCls:"icon_macro_editor",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.editMacro)}}]}},"-",{text:"Options".localize().concat("..."),disabled:true}]})},{text:"Window".localize(),cls:"extmenubaritem",menu:(menu.windowMenu=new Ext.menu.Menu({id:"WindowMenu",cls:"default-format-window",items:[{text:"Arrange".localize().concat("..."),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.arrangeWindows)}},{text:"Hide".localize(),handler:function(){Jedox.wss.workspace.hideActiveWin()}},{text:"Unhide".localize().concat("..."),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.unhideWindow)}},"-",{text:"Freeze Panes".localize(),disabled:true,menu:{cls:"default-format-window",items:[{text:"Freeze Panes".localize(),id:"FreezePane",handler:function(){Jedox.wss.sheet.freeze()}},{text:"Freeze Top Row".localize(),handler:function(){Jedox.wss.sheet.freeze([0,1])}},{text:"Freeze First Column".localize(),handler:function(){Jedox.wss.sheet.freeze([1,0])}}],listeners:{beforeshow:function(){this.items.get("FreezePane").setText(Jedox.wss.app.activeSheet._numPanes>1?"Unfreeze Panes".localize():"Freeze Panes".localize())}}}},"-"]}))},{text:"Help".localize(),cls:"extmenubaritem",menu:new Ext.menu.Menu({id:"HelpMenu",cls:"default-format-window",items:[{text:"Worksheet-Server Help".localize(),disabled:true},"-",{text:"Jedox Online".localize(),handler:function(){window.open("http://www.jedox.com","_blank")}}]})});Jedox.wss.app.Menu.render("MenuPlaceholder")};Jedox.wss.app.initActiveToolbars=function(){Jedox.wss.app.toolbar={};Jedox.wss.app.initStandardToolbar();Jedox.wss.app.initFormatToolbar();Jedox.wss.app.initDynarangeToolbar()};Jedox.wss.app.initStandardToolbar=function(){var tbar=Jedox.wss.app.toolbar;Jedox.wss.app.standardToolbar=new Ext.Toolbar({cls:"exttoolbar",renderTo:"wssStandardToolbar",items:[{iconCls:"icon_new_doc",tooltip:"Create new document".localize(),handler:Jedox.wss.action.newWorkbook},{iconCls:"icon_open_doc",cls:"x-btn-icon",tooltip:"Open document".localize(),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.open,["open"])}},(tbar.saveItem=new Ext.Toolbar.Button({iconCls:"icon_save_doc",cls:"x-btn-icon",tooltip:"Save document".localize(),handler:Jedox.wss.book.save})),(tbar.undoItem=new Ext.Toolbar.Button({id:"menuIconUndo",iconCls:"icon_undo",cls:"x-btn-icon",tooltip:"Undo".localize(),handler:Jedox.wss.sheet.undo,hidden:true})),(tbar.redoItem=new Ext.Toolbar.Button({id:"menuIconRedo",iconCls:"icon_redo",cls:"x-btn-icon",tooltip:"Redo".localize(),handler:Jedox.wss.sheet.redo,hidden:true})),"-",{iconCls:"icon_copy",cls:"x-btn-icon",tooltip:"Copy".localize(),handler:function(){Jedox.wss.action.copy(false)}},{iconCls:"icon_cut",cls:"x-btn-icon",tooltip:"Cut".localize(),handler:function(){Jedox.wss.action.cut(false)}},(tbar.paste=new Ext.Toolbar.Button({iconCls:"icon_paste",cls:"x-btn-icon",tooltip:"Paste".localize(),disabled:true,handler:Jedox.wss.action.paste})),"  "]})};Jedox.wss.app.initFormatToolbar=function(){var tbar=Jedox.wss.app.toolbar;Jedox.wss.app.formatToolbar=new Ext.Toolbar({cls:"exttoolbar",renderTo:"wssFormatToolbar",items:[new Ext.form.ComboBox({id:"tbarFonts",displayField:"fontname",valueField:"fontdef",typeAhead:true,editable:true,mode:"local",triggerAction:"all",ctCls:"toolbar-combo",selectOnFocus:true,forceSelection:true,value:Jedox.wss.app.cnfDefaultFont,listWidth:160,width:120,tpl:'<tpl for="."><div class="x-combo-list-item" style="font-family: {fontdef}; color: #15428B;">{fontname}</div></tpl>',store:new Ext.data.SimpleStore({fields:["fontname","fontdef"],data:Jedox.wss.style.fonts}),listeners:{select:{fn:Jedox.wss.app.onFormatDropdownSelect,scope:this},focus:{fn:Jedox.wss.app.onFormatDropdownFocus,scope:this},blur:{fn:Jedox.wss.app.onFormatDropdownBlur,scope:this}}})," ",(tbar.fontSizes=new Ext.form.ComboBox({id:"tbarFontSizes",displayField:"fontsize",valueField:"fontsize",typeAhead:true,editable:true,selectOnFocus:true,mode:"local",triggerAction:"all",forceSelection:false,value:Jedox.wss.app.cnfDefaultFontSize,listWidth:110,width:40,allowBlank:false,applyTo:tbar.fontSizes,tpl:'<tpl for="."><div class="x-combo-list-item" style="font-size: {fontsize}pt; color: #15428B;">{fontsize}</div></tpl>',store:new Ext.data.SimpleStore({fields:["fontsize"],data:Jedox.wss.style.fontSizes}),listeners:{change:{fn:Jedox.wss.app.onFormatDropdownChange,scope:this},select:{fn:Jedox.wss.app.onFormatDropdownSelect,scope:this},focus:{fn:Jedox.wss.app.onFormatDropdownFocus,scope:this},blur:{fn:Jedox.wss.app.onFormatDropdownBlur,scope:this},specialkey:{fn:Jedox.wss.app.onFormatDropdownSpecKey,scope:this}}}))," ",(tbar.bold=new Ext.Toolbar.Button({id:"tbarBold",iconCls:"icon_font_bold",cls:"x-btn-icon",enableToggle:true,pressed:false,toggleHandler:Jedox.wss.app.onFormatItemToggle,tooltip:"Bold".localize()})),(tbar.italic=new Ext.Toolbar.Button({id:"tbarItalic",iconCls:"icon_font_italic",cls:"x-btn-icon",enableToggle:true,pressed:false,toggleHandler:Jedox.wss.app.onFormatItemToggle,tooltip:"Italic".localize()})),(tbar.underline=new Ext.Toolbar.Button({id:"tbarUnderline",iconCls:"icon_font_underline",cls:"x-btn-icon",enableToggle:true,pressed:false,toggleHandler:Jedox.wss.app.onFormatItemToggle,tooltip:"Underline".localize()})),"-",(tbar.alignLeft=new Ext.Toolbar.Button({id:"tbarAlignLeft",iconCls:"icon_align_left",cls:"x-btn-icon",enableToggle:true,pressed:false,toggleHandler:Jedox.wss.app.onFormatItemToggle,tooltip:"Align Text Left".localize()})),(tbar.alignCenter=new Ext.Toolbar.Button({id:"tbarAlignCenter",iconCls:"icon_align_center",cls:"x-btn-icon",enableToggle:true,pressed:false,toggleHandler:Jedox.wss.app.onFormatItemToggle,tooltip:"Center text".localize()})),(tbar.alignRight=new Ext.Toolbar.Button({id:"tbarAlignRight",iconCls:"icon_align_right",cls:"x-btn-icon",enableToggle:true,pressed:false,toggleHandler:Jedox.wss.app.onFormatItemToggle,tooltip:"Align Text Right".localize()})),"-",(tbar.border=new Ext.Toolbar.SplitButton({id:"tbarBorder",iconCls:"icon-brd-bottom-norm",tooltip:"Bottom Border".localize(),handler:this.onBorderSelect,menu:{cls:"default-format-window",items:[{id:"brd-bottom-norm",text:"Bottom Border".localize(),iconCls:"icon-brd-bottom-norm",handler:this.onBorderSelect},{id:"brd-top-norm",text:"Top Border".localize(),iconCls:"icon-brd-top-norm",handler:this.onBorderSelect},{id:"brd-left-norm",text:"Left Border".localize(),iconCls:"icon-brd-left-norm",handler:this.onBorderSelect},{id:"brd-right-norm",text:"Right Border".localize(),iconCls:"icon-brd-right-norm",handler:this.onBorderSelect},"-",{id:"brd-all-norm",text:"All Borders".localize(),iconCls:"icon-brd-all-norm",handler:this.onBorderSelect},{id:"brd-out-norm",text:"Outside Borders".localize(),iconCls:"icon-brd-out-norm",handler:this.onBorderSelect},{id:"brd-out-thick",text:"Thick Outside Border".localize(),iconCls:"icon-brd-out-thick",handler:this.onBorderSelect},{id:"brd-all-none",text:"No Border".localize(),iconCls:"icon-brd-all-none",handler:this.onBorderSelect},"-",{id:"brd-top-bottom-norm",text:"Top and Bottom Border".localize(),iconCls:"icon-brd-top-bottom-norm",handler:this.onBorderSelect},{id:"brd-bottom-thick",text:"Thick Bottom Border".localize(),iconCls:"icon-brd-bottom-thick",handler:this.onBorderSelect},{id:"brd-top-norm-bottom-thick",text:"Top and Thick Bottom Border".localize(),iconCls:"icon-brd-top-norm-bottom-thick",handler:this.onBorderSelect},"-",{id:"formatCellsBorders",text:"More Borders".localize().concat("..."),iconCls:"icon-brd-more",handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.formatCells,["formatCellsBorders"])}}]}})),new Ext.Toolbar.Button({id:"tbarMergeCells",iconCls:"icon_merge_cells",cls:"x-btn-icon",handler:function(){Jedox.wss.action.mergeCells(false)},tooltip:"Merge Cells".localize()}),new Ext.Toolbar.Button({id:"tbarUnmergeCells",iconCls:"icon_unmerge_cells",cls:"x-btn-icon",handler:function(){Jedox.wss.action.mergeCells(true)},tooltip:"Unmerge Cells".localize()}),"-",new Ext.Toolbar.SplitButton({id:"tbarBgColorBtn",iconCls:"iconbgcolor",tooltip:"Fill Color".localize(),handler:Jedox.wss.app.onColorSelect,menu:(tbar.bgColor=new Ext.menu.Menu({id:"tbarBgColor",colors:Jedox.wss.style.colorPalettes[Jedox.wss.app.activeColorPalette],cls:"wide-color-palette",iconCls:"no-icon",handler:Jedox.wss.app.onColorSelect,items:[{text:"No Color".localize(),id:"bgNoColor",handler:Jedox.wss.app.onColorSelect},new Ext.ColorPalette({colors:Jedox.wss.style.colorPalettes[Jedox.wss.app.activeColorPalette],handler:Jedox.wss.app.onColorSelect})]}))}),new Ext.Toolbar.SplitButton({id:"tbarTextColorBtn",iconCls:"icontextcolor",tooltip:"Font Color".localize(),handler:Jedox.wss.app.onColorSelect,menu:new Ext.menu.ColorMenu({id:"tbarTextColor",iconCls:"no-icon",colors:Jedox.wss.style.colorPalettes[Jedox.wss.app.activeColorPalette],cls:"wide-color-palette",handler:Jedox.wss.app.onColorSelect})}),"-",new Ext.Toolbar.Button({id:"menuIconChart",iconCls:"icon_insert_chart",cls:"x-btn-icon",tooltip:"Insert Chart".localize(),handler:function(){Jedox.wss.app.load(Jedox.wss.app.dynJSRegistry.chart,["insert",0])}}),"-",(tbar.lock=new Ext.Toolbar.Button({id:"tbarLock",iconCls:"icon_lock",cls:"x-btn-icon",enableToggle:true,pressed:true,toggleHandler:Jedox.wss.general.toggleCellLock,tooltip:"Item Lock/Unlock".localize()})),"-"]});Ext.DomQuery.selectNode("*[class*=iconbgcolor]").style.borderLeft="solid 4px #FF0000";Ext.DomQuery.selectNode("*[class*=icontextcolor]").style.borderLeft="solid 4px #FFFF00"};Jedox.wss.app.initDynarangeToolbar=function(){var tbar=Jedox.wss.app.toolbar;Jedox.wss.app.hbToolbar=new Ext.Toolbar({cls:"exttoolbar",renderTo:"wssDynarangeToolbar",items:[(tbar.newHBVert=new Ext.Toolbar.Button({id:"newHBVertTbar",iconCls:"icon_vert_dynarange",cls:"x-btn-icon",tooltip:"Vertical Dynarange".localize(),handler:Jedox.wss.hb.addDynarange})),(tbar.newHBHoriz=new Ext.Toolbar.Button({id:"newHBHorizTbar",iconCls:"icon_hor_dynarange",cls:"x-btn-icon",tooltip:"Horizontal Dynarange".localize(),handler:Jedox.wss.hb.addDynarange})),(tbar.hbQuickView=new Ext.Toolbar.Button({id:"tbarHBQuickView",iconCls:"icon_designer_preview",cls:"x-btn-icon",tooltip:"Designer Preview".localize(),enableToggle:true,pressed:false,toggleHandler:Jedox.wss.hb.run})),"-",(tbar.userModeView=new Ext.Toolbar.Button({id:"tbarViewMode",iconCls:"icon_user_mode",cls:"x-btn-icon",tooltip:"Open User Mode".localize(),handler:Jedox.wss.app.openViewMode}))]})};